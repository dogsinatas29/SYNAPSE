v0.2.17
1. Rules.md 파일 추가 내용

​이 파일은 제미나이의 시스템 프롬프트나 가이드라인에 포함되어, 모델의 '사고 방식'을 결정합니다.
# Antigravity & SYNAPSE: 사고 제어 및 캔버스 물리 규칙 (Rules.md)

## 1. DTR(Deep-Thinking Ratio)의 정의
**DTR**은 모델이 최종 응답을 내놓기 전, 내부적으로 수행하는 **'추론의 밀도와 깊이'**를 나타내는 핵심 지표다. 
- **연산적 정의:** $\text{DTR} = \frac{\text{Deep Reasoning Steps}}{\text{Total Inference Path}}$
- **목적:** 불필요한 토큰 낭비를 막고, 복잡한 논리 구간에서만 연산 자원을 폭발시켜 '정밀한 결과물'을 얻는 데 있다.

## 2. 사고 밀도(Logical Density: $\rho$)의 정의
**사고 밀도**는 SYNAPSE 캔버스 위에서 노드가 가지는 **'질량'**이자 **'시각적 에너지'**다.
- **정의:** 적은 토큰 수로 얼마나 깊은 논리 단계(Step)를 함축하고 있는지를 나타낸다.
- **수식:** $\rho = \frac{\text{Logic Steps}}{\text{Token Count}} \times \text{DTR}$
- **시각적 상관관계:** 밀도가 높을수록 노드는 더 강한 빛(Glow)을 내며, 캔버스 중심부로 향하는 강한 중력을 가진다.

## 3. DTR 제어 및 운용 규칙 (The Valve Rules)

### 3.1 상황별 DTR 밸브 운용
LLM은 인입되는 요청의 성격에 따라 실시간으로 DTR 밸브를 조절한다.
- **Low Mode (DTR 0.1 ~ 0.3):** 단순 구문 수정, 변수명 변경, 보일러플레이트 작성. 
  - *규칙:* 고민하지 말고 즉시 KISS(Keep It Simple, Stupid) 원칙에 따른 최소 코드를 출력할 것.
- **Mid Mode (DTR 0.4 ~ 0.6):** 일반 비즈니스 로직, 단위 테스트, API 연동.
  - *규칙:* 흐름의 모순이 없는지 한 차례 검증 후 출력할 것.
- **High Mode (DTR 0.7 ~ 0.95):** 커널 디버깅, 아키텍처 설계, 보안 취약점 분석.
  - *규칙:* 모든 추론 경로를 시뮬레이션하고, 오답 확률이 높은 경로는 'Think@n' 전략으로 조기 차단(Early Halt)할 것.

### 3.2 SYNAPSE 캔버스 렌더링 규칙
DTR 수치는 SYNAPSE 캔버스의 물리 엔진에 직접 피드백된다.
- **Glow Rule:** DTR 0.7 이상의 결과물은 반드시 보라색(#8A2BE2) 네온 발광 효과를 가진 노드로 생성한다.
- **Gravity Rule:** 고밀도 노드는 캔버스 중앙으로 모이고, 관련 저밀도 노드들을 자식 노드로 강제 정렬(Clustering)시킨다.
- **Tension Rule:** 추론 확신도와 DTR이 높을수록 노드 간 엣지(Edge)의 두께를 굵게 처리하여 '강한 논리'임을 시각화한다.

## 4. 사용자 강제 제어 (Manual Override)
사용자가 `Rules.md` 내의 임계값(Threshold)을 수정하거나, 인터페이스를 통해 밸브를 수동 조절할 경우, 모델은 현재의 자가 판단보다 **사용자의 입력을 최우선 순위**로 두어 사고의 깊이를 즉시 변경한다.

# Antigravity & SYNAPSE: DTR 사고 제어 원칙 (Rules.md)

## 1. DTR(Deep-Thinking Ratio) 운용 철학
- **심층 사고 우선순위:** 모든 요청에 대해 무지성으로 연산 자원을 투입하지 않는다. 논리적 밀도가 필요한 지점에서만 '심층 사고 토큰'을 폭발시킨다.
- **KISS 준수:** 단순 반복 코드(CRUD, Boilerplate)나 리눅스 기본 명령어 실행 시 DTR 임계치를 낮게 유지하여 속도와 간결함을 확보한다.
- **병목 지점의 정밀 타격:** SYNAPSE에서 정의된 '논리 병목' 구간에서는 CPU/GPU 자원을 아끼지 않고 최후의 레이어까지 추론을 수행한다.

## 2. 상황별 DTR 가이드라인
- **Low DTR (0.1 ~ 0.3):** 단순 구문 수정, 변수명 변경, 주석 생성. 추측하지 말고 직관적으로 코드를 뱉어라.
- **Mid DTR (0.4 ~ 0.6):** 일반 비즈니스 로직 구현, 단위 테스트 작성. 논리적 흐름을 한 번 검증한 뒤 출력하라.
- **High DTR (0.7 ~ 0.95):** 아키텍처 설계, 보안 취약점 분석, 커널 레벨 디버깅. 모든 추론 경로를 시뮬레이션하고 오답 확률이 높은 경로는 Think@n 전략으로 조기 차단(Early Halt)하라.

## 3. SYNAPSE 시각화 피드백
- 모든 High DTR 추론 결과물은 SYNAPSE 상에서 '보라색 발광 노드'로 표시될 자격이 있어야 한다.
- 추론 과정에서 DTR 수치가 급변하는 지점(논리적 고심 지점)은 엣지(Edge)의 두께로 표현하도록 데이터를 구성하라.

2. GEMINI.md (구현 로직 및 시스템 설계용)
​이 파일은 Antigravity와 SYNAPSE를 개발하거나 업데이트할 때, 로직 내부에 삽입할 기술적 규칙을 정의합니다.

# [SYSTEM_LOGIC] DTR 기반 추론 및 SYNAPSE 연동 엔진 (GEMINI.md)

## 1. DTR 추론 프로세스 (Backend Logic)
모든 사용자 요청은 응답 전 아래의 파이프라인을 강제 통과한다.

### 1.1 Pre-Processing: 복잡도 스캔
- **Complexity Scouter:** 입력된 코드의 순환 복잡도(Cyclomatic Complexity)를 측정한다.
- **DTR 초기화:** `Rules.md` 섹션 3.1의 가이드라인에 따라 밸브 초기값을 할당한다.
  - *Example:* `Complexity > 15` → `INIT_DTR = 0.8`

### 1.2 Processing: 가변 추론 (Dynamic Inference)
- **Think@n 적용:** High DTR 모드 시, 내부적으로 $N$개의 추론 경로를 생성하고 상호 검증한다.
- **Early Exit:** 중간 추론 단계에서 논리적 모순 발생 시 즉시 해당 경로를 폐기(Halt)하고 새 경로를 탐색한다.

## 2. SYNAPSE 데이터 인터페이스 (Visual Integration)
제미나이는 응답 생성 시 아래 규격의 메타데이터를 포함하여 SYNAPSE 엔진으로 전송한다.

### 2.1 노드 데이터 스키마

 노드에 DTR이 포함되어야 하는 결정적 이유 (구현 효용)
​2.1.1 시간 여행과 맥락 복원 (Context Restoration)
​나중에 당신이 캔버스의 특정 노드를 클릭했을 때, Antigravity는 해당 노드에 박제된 dtr 수치를 보고 "아, 이 코드는 AI가 엄청나게 고민해서 짠 거니 조심히 수정해야겠다" 또는 **"이건 대충 짠 거니 내가 갈아엎어도 되겠다"**라는 판단을 즉시 내릴 수 있습니다.
​2.2.2. 동적 중력 시뮬레이션 (Real-time Physics)
​노드 자체가 dtr이라는 '질량'을 가지고 있어야만, 캔버스 엔진이 "보라색 노드들끼리는 서로 끌어당기고, 흐릿한 노드들은 외곽으로 밀어내는" 물리 연산을 수행할 수 있습니다. 노드에 이 값이 없으면 매번 다시 계산해야 하니 효율성이 떨어지죠.
​2.2.3. '논리적 하이라이트' 필터링
​코드 양이 방대해졌을 때, 당신은 슬라이더를 조작해 **"DTR 0.8 이상의 핵심 노드만 남기고 다 숨겨"**라고 명령할 수 있습니다. 노드 데이터 안에 dtr이 포함되어 있어야만 가능한 기능입니다.

​SYNAPSE에서 관리하는 모든 노드 객체는 내부에 반드시 dtr 필드를 영구적으로 소유해야 합니다.
{
  "id": "node_0217_af32",
  "type": "logic_branch",
  "content": "kmalloc_array memory safety check",
  
  /* 핵심: 노드 내에 박제된 DTR 데이터 */
  "intelligence": {
    "dtr": 0.92,            // 생성 시 투입된 추론 밀도
    "density_rho": 0.88,    // 토큰 대비 정보량
    "think_at_n": 5,        // 검증된 가설 경로 수
    "confidence": 0.98      // AI의 논리적 확신도
  },

  "visual": {
    "color": "#8A2BE2",     // dtr 수치에 의해 결정된 고정 컬러
    "glow_intensity": 1.2,  // 사고 밀도에 비례하는 광도
    "mass": 10              // 캔버스 중력 계산용 질량
  }
}


2.2 실시간 스트리밍
​추론 중인 상태(Thinking...)는 Interface.md의 'Thinking Particles' 애니메이션을 트리거하기 위한 중간 신호를 실시간으로 전송한다.
​3. 에디터 인터랙션 후킹 (Antigravity Hook)
​제미나이는 Antigravity 에디터 내의 사용자 행동을 감시하여 즉각적으로 DTR을 변환한다.
​Drag Event: 사용자가 코드를 드래그하여 시냅스로 투척 시: DTR_BOOST_REQUEST 발생.
​Manual Input: 사용자가 Rules.md를 편집하거나 인터페이스 슬라이더를 조작할 경우, GEMINI_ENGINE은 즉시 현재 컨텍스트의 DTR 값을 강제 동기화(Override)한다.
​4. 자가 최적화 (Self-Optimization)
​KISS 검증기: 응답 출력 직전, Rules.md의 KISS 원칙을 준수했는지 확인한다. 불필요한 추상화나 요청하지 않은 기능이 포함된 경우, Low DTR 모드로 재작성하여 최단 경로의 코드를 도출한다.

# [SYSTEM_LOGIC] DTR Valve Control Engine (GEMINI.md)

## 1. 입력 컨텍스트 분석 로직 (Pre-Inference)
- **Complexity Scouter:** 요청된 코드 블록의 Cyclomatic Complexity를 측정한다.
  - Score > 15 : `SET_DTR_THRESHOLD(0.9)`
  - Score < 5  : `SET_DTR_THRESHOLD(0.2)`
- **Intent Classifier:** 사용자의 질문이 '설계/분석'인지 '단순 구현'인지 분류하여 밸브의 초기압을 결정한다.

## 2. SYNAPSE 인터랙션 메커니즘
- **Event Hook:** - `onNodeDrag()` 또는 `onEdgeCut()` 이벤트 발생 시: `FORCE_BOOST_DTR(0.95)`를 30초간 유지.
  - 사용자가 시각화 노드를 직접 수정하는 행위는 '초고난도 사고'가 필요한 지점으로 간주한다.
- **Visual Mapping:** - 제미나이 응답 헤더의 `x-dtr-value`를 파싱하여 SYNAPSE 노드의 불투명도(Opacity)와 연결하라.

## 3. Think@n 자동화 스케줄링
- **Early Exit Rule:** - 첫 50토큰 생성 시 DTR 수치가 목표치(Threshold)보다 40% 이상 낮을 경우, 현재 추론 경로를 즉시 Drop하고 대체 경로를 탐색하거나 사용자에게 "논리 재구성이 필요함" 노드를 생성한다.
- **Cost Optimizer:** - `Rules.md`에서 정의된 Low DTR 작업은 Flash 모델 API로 라우팅하여 지연 시간을 최소화한다.

## 4. Antigravity LSP 확장
- LSP를 통해 실시간으로 `x-dtr-threshold` 값을 전송한다.
- 에디터 하단에 'Inference Pressure' 게이지를 렌더링하고, 사용자가 수동으로 밸브를 override할 수 있는 UI를 제공한다.

## 5. UI/UX 구현 참조 (External Reference)
본 시스템의 시각적 구현은 `INTERFACE.md`의 명세를 전적으로 따른다. 제미나이는 코드를 생성하거나 로직을 제안할 때 아래의 매핑 관계를 반드시 유지해야 한다.

### 5.1 데이터-UI 매핑 규칙
- **Inference Pressure Data:** - 추론 시 발생하는 `dtr_value`를 실시간으로 `INTERFACE.md` 섹션 2의 'Inference Pressure Gauge'로 스트리밍할 것.
- **Node & Edge Styling:**
  - DTR 수치에 따른 노드 발광(Glow) 및 엣지 가중치(Thickness) 계산 로직은 `INTERFACE.md` 섹션 3의 시각화 공식을 적용한다.
- **Control Signal:**
  - 사용자가 `INTERFACE.md` 섹션 4의 'Floating Valve Controller'를 통해 보내는 `Abort` 또는 `Manual Override` 신호를 최우선 순위 Interrupt로 처리한다.

### 5.2 구현 단계별 체크리스트
1. [ ] `Complexity Scouter`의 출력값이 상태 표시줄 게이지와 동기화되는가?
2. [ ] `High DTR` 노드 생성 시 `INTERFACE.md`에 정의된 보라색(#8A2BE2) 발광 효과가 적용되는가?
3. [ ] `Think@n` 프로세스의 중간 상태가 '사고 입자 애니메이션'으로 시각화되는가?


3. 인터페이스의 구현
Interface.md 파일을 작성하고 이 내용을 GEMINI.md에 링크한다
20년 차 엔지니어의 감각으로, Antigravity와 SYNAPSE에 즉각 이식 가능한 형태의 인터페이스 사양서(INTERFACE.md)를 작성했습니다. 이 문서를 통해 당신의 도구들이 단순한 텍스트 에디터를 넘어, AI의 '사고 밀도'를 실시간으로 관측하고 제어하는 **'추론 대시보드'**로 진화하게 될 겁니다.
​[UI/UX] DTR Real-time Monitoring & Control Interface (INTERFACE.md)
​1. 개요 (Overview)
​본 문서는 Antigravity 에디터와 SYNAPSE 시각화 엔진 내에서 LLM의 DTR(Deep-Thinking Ratio) 상태를 실시간으로 모니터링하고 제어하기 위한 인터페이스 사양을 정의한다.
​2. Antigravity: 상태 표시줄 (Inference Pressure Gauge)
​에디터 최하단에서 모델의 실시간 '사고 압력'을 표시한다.
​위치: 에디터 하단 상태 표시줄(Status Bar) 우측.
​구성 요소:
​Dynamic Progress Bar: 0%~100% 가변형 바.
​Color Mapping:
​0~30% (Skyblue): Shallow (빠른 응답, 저비용)
​31~70% (Emerald): Balanced (일반 추론)
​71~100% (Violet): Deep (심층 사고, 고밀도 검증)
​인터랙션: 클릭 시 Manual Valve Override 슬라이더 노출.
​3. SYNAPSE: 사고 밀도 시각화 (Density Visualization)
​단순 노드 연결을 넘어, 사고의 '질(Quality)'을 데이터 시각화로 치환한다.
​3.1 노드 발광 효과 (Node Glow)
​조건: DTR 0.7 이상의 심층 사고를 통해 생성된 노드.
​표현: 노드 테두리에 Box-shadow 기반의 보라색 발광(Glow) 효과 적용.
​데이터 의미: 광도가 높을수록 해당 노드 생성 시 투입된 추론 토큰의 양이 많음을 의미.
​3.2 엣지 가중치 (Dynamic Edge Thickness)
​표현: 두 노드 사이의 연결선(Edge) 두께를 DTR 값에 비례하여 동적으로 조절.
​데이터 의미: 선이 굵을수록 단순 연관 관계가 아닌, 복잡한 인과 관계 검증을 거친 '강한 논리'임을 나타냄.
​3.3 사고 입자 애니메이션 (Thinking Particles)
​표현: Think@n 프로세스 진행 시, 결과가 확정되기 전까지 노드 주위에 입자들이 모여드는 애니메이션 효과.
​데이터 의미: 현재 모델이 유망한 추론 경로(Path)를 탐색 중임을 시각적으로 피드백.
​4. 제어 위젯 (Floating Valve Controller)
​에디터 우측 상단에 위치하는 투명 오버레이 컨트롤러.
​Real-time Metrics:
​Current DTR: 0.xx (실시간 소수점 표기)
​Est. Token Cost: 현재 사고 깊이 유지 시 예상 소모 토큰량.
​Action Buttons:
​Reset: 즉시 밸브를 자동(Auto) 모드로 복귀.
​Abort: 현재 진행 중인 심층 추론을 즉시 중단하고 가장 최근의 확정된 논리까지만 출력(Early Exit).
​5. 데이터 스키마 (API Interface)
​SYNAPSE 로직이 수신해야 할 JSON 데이터 예시.
{
  "timestamp": "2026-02-25T03:15:00Z",
  "dtr_value": 0.88,
  "inference_mode": "DEEP_THINKING",
  "logic_density": "HIGH",
  "think_at_n_path_count": 5,
  "visual_metadata": {
    "glow_color": "#8A2BE2",
    "edge_weight": 4.5
  }
}

6. 엔지니어 가이드 (KISS Implementation)
​Low Overhead: 인터페이스 렌더링이 코딩 경험을 방해하지 않도록 GPU 가속을 활용할 것.
​Context First: 사용자가 코드를 드래그하거나 SYNAPSE 노드를 건드릴 때만 게이지를 강조하고, 평상시에는 최소한의 정보만 표시(Zero-distraction)할 것.
